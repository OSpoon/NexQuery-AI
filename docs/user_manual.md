# NexQuery AI 用户使用手册 (User Manual)

欢迎使用 NexQuery AI！这是一个让数据获取变得像聊天一样简单的智能平台。本文档将指导您如何充分利用平台的各项功能。

---

## 1. 快速入门

### 1.1 登录系统
*   **地址**: 请访问管理员提供的 Web 地址。
*   **账号**: 使用管理员分配的邮箱与密码登录。
*   **双重认证 (2FA)**: 为了安全，首次登录后建议在“个人中心”绑定 Google Authenticator。绑定后，每次登录需输入 6 位动态码。

### 1.2 角色说明
系统内主要有三种角色：
*   **Admin (管理员)**: 负责系统配置、用户管理、FinOps 监控。
*   **Developer (开发者/DBA)**: 负责配置数据源、管理知识库、预置复杂任务。
*   **Operator (运营人员)**: 主要的数据消费者，使用 AI 查询数据、查看报表。

---

## 2. 核心功能：AI 数据查询

进入 **Query Execution** (查询执行) 页面，这是您的主要工作台。

### 2.1 两种对话模式
系统会根据您的选择自动切换模式：

1.  **通用聊天 (General Chat)**
    *   **如何触发**: 在左上角数据源选择框中选择 `Select Data Source` (空) 或 `No Context`。
    *   **用途**: 询问通用问题，如“Excel 怎么算标准差？”、“解释一下什么是留存率”。
    *   **特点**: AI 不会尝试连接数据库，响应速度快。

2.  **SQL 数据查询 (Agentic SQL)**
    *   **如何触发**: 在左上角选择一个具体的数据源 (如 `Production DB`)。
    *   **用途**: 获取具体业务数据。
    *   **操作步骤**:
        1.  在对话框输入需求，例如：“查询上个月销售额最高的前 10 个商品”。
        2.  **换行技巧**: 输入框支持多行，按 `Shift + Enter` 换行，按 `Enter` 发送。
        3.  **歧义处理**: 如果 AI 不确定您的意思（比如“销售额”是指下定金额还是实付金额），它会弹出选项供您选择。
        4.  **结果验证**: AI 会生成 SQL 并自动填充到编辑器。点击 **Run** 执行查询。

### 2.2 智能优化
如果您懂 SQL，可以在编辑器写好 SQL 后点击 **Optimize SQL**。AI 会分析您的查询，并给出通过加索引或重写语句来提升性能的建议。

---

## 3. 任务自动化与推送

不想每天重复查数据？使用 **Query Tasks** (查询任务) 将其自动化。

### 3.1 创建任务
1.  在查询页面调试好 SQL。
2.  点击 **Save as Task**。
3.  **Schedule**: 配置 Cron 表达式（如 `0 9 * * 1` 每周一早9点），或选择 One-off 仅执行一次。

### 3.2 配置推送渠道
让数据主动找您，而不是您找数据。
*   **Email**: 在 Recipients 中填入邮箱，报表将以 CSV 附件形式发送。
*   **Webhook**: 填入企业微信/钉钉/飞书的群机器人 Webhook 地址，报表摘要将直接推送到工作群。

---

## 4. 移动端 (小程序)

NexQuery AI 提供配套微信小程序，方便随时随地看数。

*   **绑定**: 首次使用小程序需输入 Web 端账号密码进行绑定。
*   **功能**:
    *   查看所有已保存的查询任务。
    *   执行任务并预览结果 (表格/JSON)。
    *   查看历史执行记录。

---

## 5. 管理员指南 (Administration)

如果您是管理员，以下功能将帮助您更好地理系统。

### 5.1 数据源管理 (Data Sources)
*   **PII 自动发现**: 添加数据源后，系统会自动扫描敏感字段。请在 Settings 中复核这些标记，确保手机号、身份证等数据被正确脱敏 (Masking)。
*   **Schema Sync**: 建议定期点击 Sync 按钮，确保 AI 掌握最新的表结构。

### 5.2 FinOps 成本监控
访问 **FinOps** 菜单，不仅可以看系统花了多少钱，还能看“谁”花得最多。
*   **Dashboard**: 查看 Token 消耗趋势。
*   **Top Consumers**: 揪出滥用 AI 资源的用户或异常的高频查询模型。

### 5.3 AI 治理 (Feedback)
在 **AI Feedback** 菜单中，您可以查看用户点赞/点踩的记录。
*   **Promote**: 将用户修正后的优质 SQL 提炼到 **知识库 (Knowledge Base)**。
*   **效果**: 加入知识库后，AI 再遇到类似问题时会直接参考标准答案，准确率大幅提升。

---

<div align="center">
    NexQuery AI User Manual
</div>
